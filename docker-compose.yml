services:
  openjabnab:
    build: .
    image: openjabnab:latest
    ports:
      - "80:80"       # Web interface + PHP proxy (Nabaztag HTTP API)
      - "5222:5222"   # XMPP (Nabaztag device connection)
    environment:
      # Hostname or IP accessible by the Nabaztag devices
      - OJN_DOMAIN=deepcool.localdomain
      # TTS provider: "google" (free) or "acapela" (requires account)
      - OJN_TTS=google
      # Log verbosity: Debug, Warning, Error
      - OJN_LOG_LEVEL=Warning
    volumes:
      # Web runtime data: TTS audio cache, plugin assets, bootcode
      - ojn_web_data:/var/www/html/ojn_local
      # C++ server data: accounts, bunnies, ztamps, server log
      # (symlinked from /opt/openjabnab/bin/ so the binary finds them transparently)
      - ojn_server_data:/opt/openjabnab/data
    restart: unless-stopped

volumes:
  ojn_web_data:
  ojn_server_data:
